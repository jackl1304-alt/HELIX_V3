import{a as q,j as e,g as J,C as l,c as i,d as a,e as n,T as k,V as o,l as Y,G as $,h as R}from"./index-DT1WDA3F.js";import{P as O}from"./progress-CD-MOg-_.js";import{R as m,L as G,C as N,X as v,Y as b,T as h,t as S,a as H,P as U,b as I,c as X,B as F}from"./PieChart-28zE-JzH.js";import{B as M}from"./BarChart-KknFZzvB.js";function Z(){const{data:t,isLoading:x}=q({queryKey:["/api/regulatory-updates"],queryFn:async()=>{const s=await fetch("/api/regulatory-updates?limit=500");if(!s.ok)throw new Error("Failed to fetch");return s.json()}}),y=(t==null?void 0:t.length)||0,j=(t==null?void 0:t.filter(s=>s.priority<=2).length)||0,P=(t==null?void 0:t.filter(s=>s.actionRequired).length)||0,g=(t==null?void 0:t.filter(s=>s.riskLevel==="critical").length)||0,c=t?Math.max(0,100-g*5-j*2):0,p=t?Object.entries(t.reduce((s,r)=>(s[r.jurisdiction]=(s[r.jurisdiction]||0)+1,s),{})).map(([s,r])=>({name:s,value:r})):[],w=[{name:"Critical",value:(t==null?void 0:t.filter(s=>s.riskLevel==="critical").length)||0,color:"#ef4444"},{name:"High",value:(t==null?void 0:t.filter(s=>s.riskLevel==="high").length)||0,color:"#f97316"},{name:"Medium",value:(t==null?void 0:t.filter(s=>s.riskLevel==="medium").length)||0,color:"#eab308"},{name:"Low",value:(t==null?void 0:t.filter(s=>s.riskLevel==="low").length)||0,color:"#22c55e"}],T=t?(()=>{const s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=new Date,d=[];for(let u=5;u>=0;u--){const f=new Date(r.getFullYear(),r.getMonth()-u,1),B=s[f.getMonth()],E=t.filter(C=>{if(!C.publishedDate)return!1;const L=new Date(C.publishedDate);return L.getMonth()===f.getMonth()&&L.getFullYear()===f.getFullYear()}).length;d.push({month:B,count:E})}return d})():[],D=t?Object.entries(t.reduce((s,r)=>{const d=r.category||"general";return s[d]=(s[d]||0)+1,s},{})).map(([s,r])=>({name:s,value:r})).slice(0,8):[],K=s=>s>=80?"text-green-600":s>=60?"text-yellow-600":"text-red-600",A=s=>s>=80?"bg-green-100 border-green-300":s>=60?"bg-yellow-100 border-yellow-300":"bg-red-100 border-red-300";return e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Executive Regulatory Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Strategic Oversight & Compliance KPIs"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(J,{className:"h-4 w-4"}),"Last Updated: ",new Date().toLocaleDateString("de-DE")]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(l,{children:[e.jsx(i,{className:"pb-3",children:e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"Total Regulations"})}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold",children:y}),e.jsxs("div",{className:"flex items-center gap-1 mt-2 text-sm text-green-600",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{children:"Active monitoring"})]})]})]}),e.jsxs(l,{children:[e.jsx(i,{className:"pb-3",children:e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"High Priority"})}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold text-orange-600",children:j}),e.jsxs("div",{className:"text-sm text-muted-foreground mt-2",children:[(j/Math.max(y,1)*100).toFixed(1),"% of total"]})]})]}),e.jsxs(l,{children:[e.jsx(i,{className:"pb-3",children:e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"Action Required"})}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:P}),e.jsxs("div",{className:"flex items-center gap-1 mt-2 text-sm text-muted-foreground",children:[e.jsx(o,{className:"h-4 w-4"}),e.jsx("span",{children:"Pending tasks"})]})]})]}),e.jsxs(l,{className:`border-2 ${A(c)}`,children:[e.jsx(i,{className:"pb-3",children:e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"Compliance Score"})}),e.jsxs(n,{children:[e.jsx("div",{className:`text-3xl font-bold ${K(c)}`,children:c}),e.jsx(O,{value:c,className:"mt-2"}),e.jsx("div",{className:"flex items-center gap-1 mt-2 text-sm",children:c>=80?e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-green-600",children:"Excellent"})]}):c>=60?e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"h-4 w-4 text-yellow-600"}),e.jsx("span",{className:"text-yellow-600",children:"Monitor"})]}):e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"text-red-600",children:"Urgent"})]})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(l,{children:[e.jsx(i,{children:e.jsxs(a,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5"}),"Regulatory Activity Trend"]})}),e.jsx(n,{children:x?e.jsx("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"Loading..."}):e.jsx(m,{width:"100%",height:300,children:e.jsxs(G,{data:T,children:[e.jsx(N,{strokeDasharray:"3 3"}),e.jsx(v,{dataKey:"month"}),e.jsx(b,{}),e.jsx(h,{}),e.jsx(S,{}),e.jsx(H,{type:"monotone",dataKey:"count",stroke:"#3b82f6",strokeWidth:2,name:"New Regulations"})]})})})]}),e.jsxs(l,{children:[e.jsx(i,{children:e.jsxs(a,{className:"flex items-center gap-2",children:[e.jsx(o,{className:"h-5 w-5"}),"Risk Distribution"]})}),e.jsx(n,{children:x?e.jsx("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"Loading..."}):e.jsx(m,{width:"100%",height:300,children:e.jsxs(U,{children:[e.jsx(I,{data:w,cx:"50%",cy:"50%",labelLine:!1,label:({name:s,value:r})=>`${s}: ${r}`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:w.map((s,r)=>e.jsx(X,{fill:s.color},`cell-${r}`))}),e.jsx(h,{})]})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(l,{children:[e.jsx(i,{children:e.jsxs(a,{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-5 w-5"}),"Jurisdictional Coverage"]})}),e.jsx(n,{children:x?e.jsx("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"Loading..."}):e.jsx(m,{width:"100%",height:300,children:e.jsxs(M,{data:p.slice(0,10),children:[e.jsx(N,{strokeDasharray:"3 3"}),e.jsx(v,{dataKey:"name"}),e.jsx(b,{}),e.jsx(h,{}),e.jsx(S,{}),e.jsx(F,{dataKey:"value",fill:"#8b5cf6",name:"Regulations"})]})})})]}),e.jsxs(l,{children:[e.jsx(i,{children:e.jsx(a,{children:"Category Breakdown (Top 8)"})}),e.jsx(n,{children:x?e.jsx("div",{className:"h-64 flex items-center justify-center text-muted-foreground",children:"Loading..."}):e.jsx(m,{width:"100%",height:300,children:e.jsxs(M,{data:D,layout:"horizontal",children:[e.jsx(N,{strokeDasharray:"3 3"}),e.jsx(v,{type:"number"}),e.jsx(b,{type:"category",dataKey:"name",width:120}),e.jsx(h,{}),e.jsx(F,{dataKey:"value",fill:"#06b6d4"})]})})})]})]}),g>0&&e.jsxs(l,{className:"border-red-300 bg-red-50",children:[e.jsx(i,{children:e.jsxs(a,{className:"flex items-center gap-2 text-red-900",children:[e.jsx(o,{className:"h-5 w-5"}),"Critical Risk Items (",g,")"]})}),e.jsx(n,{children:e.jsx("div",{className:"space-y-2",children:t==null?void 0:t.filter(s=>s.riskLevel==="critical").slice(0,5).map(s=>e.jsx("div",{className:"p-3 bg-white rounded border border-red-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium line-clamp-1",children:s.title}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsxs(R,{variant:"destructive",children:["P",s.priority]}),e.jsx(R,{variant:"outline",children:s.jurisdiction})]})]}),s.complianceDeadline&&e.jsxs("div",{className:"text-sm text-red-600 font-medium",children:["Deadline: ",new Date(s.complianceDeadline).toLocaleDateString("de-DE")]})]})},s.id))})})]}),e.jsxs(l,{children:[e.jsx(i,{children:e.jsx(a,{children:"Summary Statistics"})}),e.jsx(n,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 border rounded",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:p.length}),e.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Jurisdictions"})]}),e.jsxs("div",{className:"text-center p-4 border rounded",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:D.length}),e.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Categories"})]}),e.jsxs("div",{className:"text-center p-4 border rounded",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:(t==null?void 0:t.filter(s=>s.publishedDate&&new Date(s.publishedDate)>=new Date(Date.now()-30*24*60*60*1e3)).length)||0}),e.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Last 30 Days"})]}),e.jsxs("div",{className:"text-center p-4 border rounded",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:(t==null?void 0:t.filter(s=>s.complianceDeadline&&new Date(s.complianceDeadline)<=new Date(Date.now()+90*24*60*60*1e3)).length)||0}),e.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Deadlines (90d)"})]})]})})]})]})}export{Z as default};
